.panel
  .panel-heading
    .col-md-12
      %h1
        Finalisez votre compte !
  .panel-body
    %form{"ng-submit" => "submit()", name: "finalizeForm", "ng-if" => "!submitted"}
      .col-md-12
        %p
          Renseignez les informations complémentaires suivantes afin de terminer votre compte.

      .col-md-4

        .step-container
          .step-number
            1
          .step-label-container
            .step-label
              VOTRE ÉGLISE
            .step-sublabel
              ou votre commaunauté

        %label{"ng-if" => "currentUser.church_id == null"}
          Recherchez une église ...

        %form{"ng-submit" => "chooseChurch()", name: "chooseChurch", "ng-if" => "!submitted"}
          .church-chooser.form-group

            %div.searching-churches{"ng-if" => "searchingChurches"}
              %i.fa.fa-cog.fa-spin

            %input.form-control{type: :text, "ng-model" => "church.name", "ng-model-options" => "{ updateOn: 'default blur', debounce: {'default': 800, 'blur': 0} }", "ng-if" => "currentUser.church_id == null"}

            .churches-results{"ng-if" => "!searchingChurches"}
              %bu-churches-show{"ng-repeat" => "church in churches", church: "church"}

      .col-md-4
        .step-container
          .step-number
            2
          .step-label-container
            .step-label
              VOTRE PHOTO
            .step-sublabel
              de profil

        .form-group.avatar-cropper

          %div.file-input-wrapper{"ng-hide" => "avatarImage"}
            .file-input-button{"ng-if" => "currentUser.avatar"}
              %i.fa.fa-pencil
              %img.avatar{"ng-src" => "{{currentUser.avatar.original}}"}

            %input.avatar-pic-input.form-control#avatarFileInput{type: :file, name: "user[avatar]"}
            -# %input#fileInput{:type => "file"}/

          .crop-area{"ng-show" => "avatarImage && !avatarValidated"}
            .cancel-btn.btn-xs.btn.btn-primary{"ng-click" => "avatarImage = null; avatarValidated = false"}
              %i.fa.fa-arrow-circle-o-left
              CHANGER
            .valid-btn.btn-xs.btn.btn-success{"ng-click" => "avatarValidated = true"}
              %i.fa.fa-check-circle
              OK
            %img-crop.text-center{"area-type" => "circle", "canvas-scalemode" => "true", :chargement => "'Chargement ...'", :image => "avatarImage", "result-image" => "croppedAvatarImage", "result-image-size" => "{w:350,h:350}"}

          %div.avatar-validated{"ng-if" => "avatarValidated", "ng-class" => "avatarUploaded ? 'uploaded' : ''"}
            %img.cropped-image{"ng-src" => "{{croppedAvatarImage}}", "ng-class" => "avatarUploaded ? 'uploaded' : ''"}/
            .progress-count{"ng-class" => "avatarUploading ? 'active' : ''"}
              {{progress}}%
            .progress-success{"ng-class" => "avatarUploaded ? 'active' : ''"}
              %i.fa.fa-check-circle

            %round-progress{:animation => "easeInOutQuart", "animation-delay" => "1000", :bgcolor => "#eaeaea", :clockwise => "true", :color => "#e72510", :current => "progress", :duration => "800", :max => "max", :radius => "100", :responsive => "true", :rounded => "true", :stroke => "5"}
      .col-md-4
        .step-container
          .step-number
            3
          .step-label-container
            .step-label
              LES INSTRUMENTS
            .step-sublabel
              que vous pratiquez
